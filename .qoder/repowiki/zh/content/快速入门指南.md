# 快速入门指南

<cite>
**本文档中引用的文件**
- [README.md](file://README.md)
- [src/index.ts](file://src/index.ts)
- [src/client/LxnsApiCLient.ts](file://src/client/LxnsApiCLient.ts)
- [src/client/types.ts](file://src/client/types.ts)
- [src/apis/maimai/public.ts](file://src/apis/maimai/public.ts)
- [src/apis/maimai/dev.ts](file://src/apis/maimai/dev.ts)
- [src/apis/maimai/personal.ts](file://src/apis/maimai/personal.ts)
</cite>

## 目录
1. [简介](#简介)
2. [安装 SDK](#安装-sdk)
3. [创建客户端实例](#创建客户端实例)
4. [使用公共 API（无需 Token）](#使用公共-api无需-token)
5. [使用开发者 API（devAccessToken）](#使用开发者-api-devaccesstoken)
6. [使用个人 API（personalAccessToken）](#使用个人-api-personalaccesstoken)
7. [配置 baseURL（对接私有部署）](#配置-baseurl对接私有部署)
8. [异步操作与错误处理](#异步操作与错误处理)

## 简介
本指南旨在帮助新用户在 5 分钟内完成 `lxns-rhythm-api` SDK 的环境搭建并成功发出第一个请求。我们将涵盖从安装、初始化到三种典型使用场景的完整流程，确保即使从未接触过该项目的开发者也能快速上手。

**Section sources**
- [README.md](file://README.md#L0-L104)

## 安装 SDK
您可以通过主流的包管理器安装 `lxns-rhythm-api`。以下是不同工具的安装命令：

```bash
# npm
npm i lxns-rhythm-api

# pnpm
pnpm add lxns-rhythm-api

# yarn
yarn add lxns-rhythm-api
```

该 SDK 无运行时依赖（仅使用 `ky` 发起 HTTP 请求），支持现代构建工具，并提供完整的 TypeScript 类型定义。

**Section sources**
- [README.md](file://README.md#L10-L19)

## 创建客户端实例
SDK 的核心是 `LxnsApiClient` 类，位于主模块中。您需要从主包导入该类并创建实例。

```ts
import { LxnsApiClient } from "lxns-rhythm-api";

// 创建一个基础客户端（仅可访问公共 API）
const client = new LxnsApiClient();
```

客户端构造函数接受一个可选的配置对象，用于指定认证令牌和基础 URL。

**Section sources**
- [src/index.ts](file://src/index.ts#L0-L3)
- [src/client/LxnsApiCLient.ts](file://src/client/LxnsApiCLient.ts#L12-L78)

## 使用公共 API（无需 Token）
当不提供任何 token 时，客户端仅能访问 `maimai.public` 命名空间下的公共接口，例如获取歌曲信息或歌曲列表。

```ts
const client = new LxnsApiClient();
const song = await client.maimai.public.getSong(114);
console.log(song.standard?.master);
```

此模式适用于展示曲目数据、别名列表等公开信息，无需用户授权。

**Section sources**
- [README.md](file://README.md#L22-L26)
- [src/apis/maimai/public.ts](file://src/apis/maimai/public.ts#L0-L103)

## 使用开发者 API（devAccessToken）
通过传入 `devAccessToken`，您可以启用 `maimai.dev` 命名空间，调用开发者专属接口，如根据 QQ 号查询玩家信息或上传成绩。

```ts
const devClient = new LxnsApiClient({
  devAccessToken: "<your-dev-token>",
});
const player = await devClient.maimai.dev.getPlayerByQQ(1507524536);
console.log(player);
```

此时，SDK 会自动在请求头中添加 `Authorization: <devAccessToken>` 并指向正确的 API 路径。

**Section sources**
- [README.md](file://README.md#L28-L33)
- [src/apis/maimai/dev.ts](file://src/apis/maimai/dev.ts#L0-L149)

## 使用个人 API（personalAccessToken）
通过传入 `personalAccessToken`，您可以启用 `maimai.personal` 命名空间，访问和管理用户的个人数据，如获取自己的最佳成绩或上传游玩记录。

```ts
const personalClient = new LxnsApiClient({
  personalAccessToken: "<your-personal-token>",
});
const me = await personalClient.maimai.personal.getPlayer();
console.log(me);
```

此时，SDK 会使用 `X-User-Token` 请求头，并将基础路径设置为 `/user/maimai/`。

**Section sources**
- [README.md](file://README.md#L35-L40)
- [src/apis/maimai/personal.ts](file://src/apis/maimai/personal.ts#L0-L41)

## 配置 baseURL（对接私有部署）
如果您正在使用私有部署的 Lxns API 服务，可以通过 `baseURL` 选项自定义 API 地址。

```ts
const client = new LxnsApiClient({
  baseURL: "https://your-private-api.example.com/api/v0/",
  personalAccessToken: "<token>",
});
```

默认情况下，`baseURL` 为 `https://maimai.lxns.net/api/v0/`。修改此选项后，所有请求将基于新的根地址发起。

**Section sources**
- [README.md](file://README.md#L42-L58)
- [src/client/LxnsApiCLient.ts](file://src/client/LxnsApiCLient.ts#L12-L14)

## 异步操作与错误处理
SDK 所有 API 方法均返回 Promise，因此必须使用 `async/await` 或 `.then()` 进行调用。建议使用 `try-catch` 捕获可能的网络错误或 API 错误。

```ts
try {
  const client = new LxnsApiClient();
  const song = await client.maimai.public.getSong(114);
  console.log("获取成功:", song.title);
} catch (error) {
  console.error("请求失败:", error);
}
```

这可以有效防止未处理的 Promise rejection 导致程序崩溃。

**Section sources**
- [README.md](file://README.md#L22-L40)
- [src/client/LxnsApiCLient.ts](file://src/client/LxnsApiCLient.ts#L50-L78)